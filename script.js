The optimized final complete code is provided above.